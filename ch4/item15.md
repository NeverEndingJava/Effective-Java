# 클래스와 멤버의 접근 권한을 최소화하라

`요약`
  - 꼭 필요한 것만 골라 최소한의 public API를 설계하자. 
  
  - public 클래스는 상수(불변) 외에는 public필드를 가지면 안된다.

## 잘 설계된 컴포넌트

- 클래스 내부 데이터와 구현 정보를 외부로부터 잘 숨김

- 오직 API를 통해서 다른 컴포넌트와 소통 (서로 내부 동작 방식을 모름)
 
- 즉, `정보 은닉`, `캡슐화`가 중요!

## 정보 은닉이란?

- 다른 객체에게 자신의 정보를 숨기고 자신의 연산만을 통해 접근을 허용하는 것

## 정보 은닉의 장점

- 시스템 `개발 속도를 높인다`

    - 여러 컴포넌트를 `병렬`로 개발 가능
  
- 시스템 `관리 비용을 낮춘다`

    - 각 컴포넌트를 더 빨리 파악하고, 디버깅 가능
  
    - 다른 컴포넌트로 교체하는 부담이 적음
  
- `성능 최적화`에 도움을 준다

    - 다른 컴포넌트에 영향을 주지 않고 해당 컴포넌트만 최적화 가능
  
- 소프트웨어 `재사용성`을 높인다

    - 외부에 거의 의존하지 않고 독자적으로 동작할 수 있는 컴포넌트는 낯선 환경에서도 유용하게 쓰일 가능성이 큼

- 큰 시스템을 제작하는 난이도를 낮춰준다

    - 개발중에도 개별 컴포넌트의 동작을 검증할 수 있음

즉, `모든 클래스와 멤버의 접근성을 가능한 한 좁히는 것이 좋다.`

### 접근 제어자

- Java는 이 정보 은닉을 위해 다양한 장치를 제공한다.  

- `class`, `interface`, `member` 는 접근 제어자를 통해 접근 허용 범위가 명시된다.  

> member: 필드, 메소드, 중첩 클래스, 중첩 인터페이스, 등등

### 클래스에 부여하는 접근 수준

#### 톱 레벨 클래스, 인터페이스

> 톱 레벨: 가장 바깥이라는 뜻

- `package-private`(`default`): 해당 패키지 안에서만 이용 (=내부 구현)

- `public`: 공개 API (클라이언트에 영향)

- 톱 레벨 클래스와 인터페이스에는 `public`과` package-private` 만 부여할 수 있다

    - public으로 선언하면 공개 API가 되어 하위 호환을 위해 영원히 관리해줘야 한다
  
    - package-private로 선언하면 해당 패키지 안에서만 사용할 수 있다
  
    - 외부에서 쓸 이유가 없다면 package-private로 선언하여 내부구현으로 만들자

- 톱 레벨에 위치한다는 건 같은 패키지의 모든 클래스가 접근할 수 있다는 의미이다.  

  - 한 클래스에서만 사용하는 package-private 톱레벨 클래스나 인터페이스는 이를 사용하는 클래스 안에 private static으로 중첩시키자
  
  - `private static`을 중첩시키면 바깥 클래스 하나에서만 접근할 수 있다.

### 멤버(필드, 메서드, 중첩 클래스, 중첩 인터페이스)에 부여하는 접근 수준

- public, protected, package-private, private 모두 부여할 수 있다

  - `private`: 해당 클래스에서만 접근 가능
  
  - `package-private`: 클래스와 같은 패키지에서 접근 가능
  
  - `protected`: 같은 패키지 + 하위 클래스의 패키지에서 접근 가능
  
  - `public`: 모든 곳에서 접근 가능

#### 주의사항

- `protected`와 `public`은 해당 클래스의 구현을 벗어나 공개 API에 영향을 줄 수 있다.

- protected 멤버 수는 적을수록 좋다

  - package-private에서 protected로 변경하는 순간 접근할 수 있는 대상 범위가 넓어진다

- 테스트만을 위해 클래스, 인터페이스, 멤버를 공개 API로 만들면 안된다

- public클래스의 인스턴스 필드는 상수가 아니라면 되도록 public이 아니여야 한다

- 클래스에 길이가 0이 아닌 public static final배열 필드를 두거나 이 필드를 반환하는 접근자 메서드를 제공하면 안된다

  - 배열의 내용이 수정될 수 있다

- 권한을 풀어주는 일이 지나치게 많아지면 컴포넌트를 더 분리해야하는 것이 아닌지 고민해야 한다.

- `private`와 `package-private`는 내부 구현용이지만 예외적으로 Serializable을 직접 구현한 클래스에서는 공개 API가 될 수도 있다.


#### 멤버 접근성의 제약

- 리스코프 치환 원칙에 의해 상위 클래스의 메소드를 재정의하는 경우, 그 접근 수준을 상위 클래스보다 좁게 설정할 수 없다.

`리스코프 치환 원칙이란?`

> 상위 타입의 객체를 하위 타입의 객체로 치환해도 동작에 문제가 없어야하는 규칙